language: c
os: linux
dist: focal
services:
  - docker
addons:
  apt:
    packages:
      - docker.io
before_script:
  - docker-compose pull
  - docker-compose build
  - docker-compose up -d
  - docker ps
after_script:
  - docker-compose down
script:
  - sleep 20
  - docker-compose exec -e RELEASE="1" -e CONFIG_FILE="libnss-maria-docker.conf" sys sh -c "/home/libnss-maria/scripts/compile_and_test.sh"
env:
  - DISTRO="debian"
  - DISTRO="ubuntu"
  - DISTRO="ubuntu-lts"
  - DISTRO="centos"
  - DISTRO="fedora"
  - DISTRO="archlinux"
